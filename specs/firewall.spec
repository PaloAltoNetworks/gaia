# Model
model:
  rest_name: firewall
  resource_name: firewalls
  entity_name: Firewall
  package: ngfw ## ???
  group: ngfw/firewall ## ???
  description: |-
    TODO
  get:
    description: Retrieves the firewall with the given ID.
  update:
    description: Updates the firewall with the given ID.
  delete:
    description: Deletes the firewall with the given ID.
    global_parameters:
    - $filtering
  extends:
  - '@zoned'
  - '@identifiable-stored'
  - '@named'
  - '@described'
  - '@base'
  - '@migratable'
  - '@namespaced'   

# Indexes
indexes:
- - namespace

# Attributes
attributes:
  v1:
  - name: customerID
    description: The AWS Customer ID.  TODO Should this be stored here?
    type: string
    exposed: true
    stored: true

  - name: mode
    description: The mode of the firewall.
    type: enum
    exposed: true
    stored: true
    read_only: true # Cant be changed
    allowed_choices:
    - Tap
    - NGFW
    default_value: Tap
    filterable: true

  - name: status
    description: The status of the firewall.
    type: enum
    exposed: true
    stored: true
    read_only: true # Not sure if this correct. Only the backend can set the status.
    allowed_choices:
    - Creating
    - Ready
    default_value: Creating
    filterable: true
    transient: true # ???
    autogenerated: true # ???

  - name: attachments.
    description: |-
      The firewall subnet attachments.
    type: list
    subtype: firewallattachment
    extensions:
      refMode: pointer
    exposed: true
    stored: true

  - name: logs
    description: |-
      The log settings for the firewall.
    type: list
    subtype: firewalllog
    extensions:
      refMode: pointer
    exposed: true
    stored: true 

  - name: rulestack
    description: The current NGFW rulestack associated with the firewall
    type: string
    exposed: true
    stored: true
    read_only: true # Only the backend can set the value.